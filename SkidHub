local function TypingEffect(label, text, speed)
    label.Text = ""
    for i = 1, #text do
        label.Text = string.sub(text, 1, i)
        wait(speed)
    end
end
shared.LoaderTitle = ''
local Metadata = {
    LoaderData = {
        Colors = shared.LoaderColors or {
            Main = Color3.fromRGB(40, 40, 40),
            LoaderBackground = Color3.fromRGB(28, 28, 28),
        }
    },
    Keyframes = shared.LoaderKeyFrames or {
        [1] = {0.5, 40},
        [2] = {0.7, 80},
        [3] = {0.5, 100},
    }
}
local StepTexts = {
    [1] = "Đang tải dữ liệu và kiểm tra hệ thống...",
    [2] = "Chuẩn bị giao diện và xử lý thông tin...",
    [3] = "Hoàn tất. Hãy dùng bản chính thức!"
}
function TweenObject(object, speed, info)
    game.TweenService:Create(object, TweenInfo.new(speed, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), info):Play()
end
function CreateObject(className, properties)
    local instance = Instance.new(className)
    local parent
    for propertyName, propertyValue in pairs(properties) do
        if propertyName ~= "Parent" then
            instance[propertyName] = propertyValue
        else
            parent = propertyValue
        end
    end
    instance.Parent = parent
    return instance
end
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local userId = player.UserId
local userName = player.Name
local thumbType = Enum.ThumbnailType.HeadShot
local thumbSize = Enum.ThumbnailSize.Size420x420
local content, isReady = Players:GetUserThumbnailAsync(userId, thumbType, thumbSize)
local function CreateUICorner(radius, parent)
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, radius)
    UICorner.Parent = parent
end
local Core = CreateObject("ScreenGui", {
    Name = "Core",
    Parent = game.CoreGui
})
local Main = CreateObject("Frame", {
    Name = "Main",
    Parent = Core,
    BackgroundColor3 = Metadata.LoaderData.Colors.Main,
    BorderSizePixel = 3,
    ClipsDescendants = true,
    Position = UDim2.new(0.5, 0, 0.5, 0),
    AnchorPoint = Vector2.new(0.5, 0.5),
    Size = UDim2.new(0, 0, 0, 0),
})
CreateUICorner(15, Main)
local UserImage = CreateObject("ImageLabel", {
    Name = "UserImage",
    Parent = Main,
    BackgroundTransparency = 1,
    Image = content,
    Position = UDim2.new(0, 15, 0, 10),
    Size = UDim2.new(0, 60, 0, 60),
})
CreateUICorner(30, UserImage)
local UserName = CreateObject("TextLabel", {
    Name = "UserName",
    Parent = Main,
    BackgroundTransparency = 1,
    Text = "",
    Position = UDim2.new(0, 80, 0, 10),
    Size = UDim2.new(0, 240, 0, 50),
    Font = Enum.Font.GothamBold,
    TextColor3 = Color3.fromRGB(255, 255, 255),
    TextStrokeTransparency = 0,
    TextStrokeColor3 = Color3.fromRGB(0, 0, 0),
    TextSize = 16,
    TextXAlignment = Enum.TextXAlignment.Left,
})
local StepLabel = CreateObject("TextLabel", {
    Name = "StepLabel",
    Parent = Main,
    BackgroundTransparency = 1,
    Position = UDim2.new(0.5, 0, 1, -25),
    Size = UDim2.new(1, -20, 0, 20),
    Text = "",
    Font = Enum.Font.SourceSansBold,
    TextColor3 = Color3.fromRGB(255, 255, 255),
    TextStrokeTransparency = 0,
    TextStrokeColor3 = Color3.fromRGB(0, 0, 0),
    TextSize = 24,
    TextXAlignment = Enum.TextXAlignment.Center,
    AnchorPoint = Vector2.new(0.5, 0.5)
})
local BG = CreateObject("Frame", {
    Name = "BG",
    Parent = Main,
    AnchorPoint = Vector2.new(0.5, 0),
    BackgroundTransparency = 1,
    BackgroundColor3 = Metadata.LoaderData.Colors.LoaderBackground,
    BorderSizePixel = 0,
    Position = UDim2.new(0.5, 0, 0, 70),
    Size = UDim2.new(0.85, 0, 0, 24),
})
CreateUICorner(12, BG)
local Progress = CreateObject("Frame", {
    Name = "Progress",
    Parent = BG,
    BorderSizePixel = 0,
    Size = UDim2.new(0, 0, 0, 24),
})
CreateUICorner(12, Progress)
local UIGradient = Instance.new("UIGradient", Progress)
UIGradient.Color = ColorSequence.new(Color3.fromRGB(255, 255, 255), Color3.fromRGB(0, 0, 0))
UIGradient.Rotation = 45
function UpdateStepText(step)
    TypingEffect(StepLabel, StepTexts[step] or "", 0.03)
end
function UpdatePercentage(percentage, step)
    TweenObject(Progress, 0.3, {
        Size = UDim2.new(percentage / 100, 0, 0, 24)
    })
    UpdateStepText(step)
end
function AnimeAppear(object, speed)
    TweenObject(object, speed, {
        Position = UDim2.new(0.5, 0, 0.5, 0),
        Size = UDim2.new(0, 350, 0, 160)
    })
end
function AnimeDisappear(object, speed)
    TweenObject(object, speed, {
        Position = UDim2.new(0.5, 0, 1, 0),
        Size = UDim2.new(0, 0, 0, 0)
    })
end
AnimeAppear(Main, 0.5)
wait(0.5)
TypingEffect(UserName, "Chào Mừng: " .. player.DisplayName, 0.03)
wait(0.3)
for i, v in pairs(Metadata.Keyframes) do
    wait(v[1])
    UpdatePercentage(v[2], i)
end
wait(1)
AnimeDisappear(Main, 0.5)
wait(0.5)
